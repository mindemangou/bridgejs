(function(s,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("htmx.org")):typeof define=="function"&&define.amd?define(["exports","htmx.org"],r):(s=typeof globalThis<"u"?globalThis:s||self,r(s.magiccomponents={},s.htmx))})(this,function(s,r){"use strict";var L=Object.defineProperty;var q=(s,r,l)=>r in s?L(s,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[r]=l;var p=(s,r,l)=>q(s,typeof r!="symbol"?r+"":r,l);const l=new Map;let g=0;const k=(t,e)=>{class i extends HTMLElement{constructor(){super()}connectedCallback(){var f;const o=this.getAttribute("data-key");if(o){const d=`key_${g}`;g++,l.set(d,o)}if(((f=this.parentElement)==null?void 0:f.tagName)==="TEMPLATE")return;const u=E(this);t({element:this,props:u})}disconnectedCallBack(){e&&e({element:this})}}return i},w=(t,e)=>{customElements.get(t)||customElements.define(t,e)},O=t=>{const e=t.reduce((n,o)=>(n[o]=(n[o]||0)+1,n),{});return Object.entries(e).filter(([n,o])=>o>1)},M=t=>{const e=O(t);if(e.length>0)for(const i of e){const[n]=i;throw new Error(`The key '${n}' already exists`)}},$=async(t,e,i=null)=>{const n=k(e,i);w(t,n),M([...l.values()])},b=(t,e)=>{const i=location.href,n=Object.fromEntries(new URL(location.toString()).searchParams.entries());let o=`?${new URLSearchParams({...n,...t}).toString()}`,a=location.hash;return e.length>0&&(a=`#${e}`),`${i}${o}${a}`},C=({tagname:t,key:e},i={},n="")=>{const o=b(i,n),a=e?`${t}[data-key='${e}']`:`${t}:nth-child(1 of ${t})`;return document.querySelector(a)===null?Promise.reject("Target not found "):r.ajax("GET",o,{target:a,select:a,swap:"outerHTML"})},E=t=>{var f;const e={...t.dataset},n=Object.entries(e).map(d=>{const[h,m]=d;try{return m?[h,JSON.parse(m)]:[h,m]}catch{return[h,m]}}),o=new Map(n),a=t.querySelector("template");if(a){const d=(f=a==null?void 0:a.content.textContent)==null?void 0:f.trim(),h=d?JSON.parse(d):{};o.set("data",h)}o.set("tagName",t.tagName.toLowerCase());const u=Object.fromEntries(o);return console.log(u),u};let y=0,c=null;const S=async(t,e)=>{var n;if(r.config.refreshOnHistoryMiss===!1)return console.warn("Redirect is not enabled"),!1;const i=document.body;c&&(r.trigger(c,"htmx:abort",{}),(n=c.parentElement)==null||n.remove(),c=null),i.innerHTML+=`<span hx-disinherit="*" class='link-parent'> 
    <a class='bridge-redirect-link' href='${t}' hx-headers='${JSON.stringify(e)}' hx-boost='true' id='bridge-redirect-link-${y}'></a> 
  </span>`,r.process(document.body),c=i.querySelector(`.link-parent>#bridge-redirect-link-${y}`),c==null||c.click(),y++},P=async({redirect:t,loader:e})=>{if(t&&(r.config.refreshOnHistoryMiss=!0),e!=null&&e.enable){await Promise.resolve().then(()=>j);const i=document.createElement("bridge-loader");i.setAttribute("data-color",e.color??"#639ef4"),document.body.append(i)}};class T extends HTMLElement{constructor(){super();p(this,"animationOne");p(this,"animationTwo")}connectedCallback(){const i=this.getAttribute("data-color")??"#639ef4";this.style.height="0.2rem",this.style.width="0",this.style.position="fixed",this.style.top="0",this.style.left="0",this.style.zIndex="9999",this.style.backgroundColor=i,this.style.display="none",r.on("htmx:beforeRequest",n=>{var a;const o=n;(a=o==null?void 0:o.detail)!=null&&a.boosted&&(this.style.display="block",this.animationOne=this.animate([{width:0},{width:"88%"}],{duration:7e3,fill:"forwards"}),this.animationOne.addEventListener("finish",()=>{this.animationTwo=this.animate([{width:"88%"},{width:"95%"}],{duration:5e3,iterations:1/0})}))})}disconnectedCallback(){var i,n;this.animationOne&&((i=this.animationOne)==null||i.cancel()),this.animationTwo&&((n=this.animationTwo)==null||n.cancel())}}customElements.define("bridge-loader",T);const j=Object.freeze(Object.defineProperty({__proto__:null,MagicLoader:T},Symbol.toStringTag,{value:"Module"}));s.config=P,s.define=$,s.getPath=b,s.getProps=E,s.redirect=S,s.reload=C,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
